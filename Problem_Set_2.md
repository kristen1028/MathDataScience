# -*- coding: utf-8 -*-
# Problem Set 2
Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1noFFUDtZzA5VH57kVLVgkjcYxsgUYUbd
"""

# Import necessary libraries and modules
```python
import numpy as np
import matplotlib.pyplot as plt
import base64
from io import BytesIO
from scipy.signal import convolve2d
from skimage import data, color, io
import IPython

import numpy as np
import matplotlib.pyplot as plt
import torch
from torchvision import datasets
from skimage.util import montage
!pip install wandb
import wandb as wb
from skimage.io import imread
from skimage.transform import resize
```

# Function to plot images
```python
def plot(x):
    fig, ax = plt.subplots()
    im = ax.imshow(x, cmap='gray')
    ax.axis('off')
    fig.set_size_inches(5, 5)
    plt.show()
```


# Load an RGB image from a URL
```python
image = io.imread("https://th.bing.com/th/id/OIP.himN5x0Zvru00xUdk3p55QHaE8?pid=ImgDet&rs=1")
image = image[:, :, :3]
plot(image)
```

# Display the shape of the image
```python
image.shape
```

# Resize the image to 224x224
```python
image_resize = resize(image, (224, 224))
plot(image_resize)
```

# Display the shape of the resized image
```python
image_resize.shape
```

# Convert the resized image to grayscale and plot image
```python
image_gray = np.mean(image_resize, axis=2)
plot(image_gray)
```

# Load the image again for further processing
```python
image = io.imread("https://th.bing.com/th/id/OIP.himN5x0Zvru00xUdk3p55QHaE8?pid=ImgDet&rs=1")
image = image[:, :, 0]  # Select the first channel (R) from the image
image = image.astype(float)
image /= 255.0
plot(image)
```

# Define a filter (kernel)
```python
a = np.matrix([[1, 2, 1], [0, 0, 0], [-1, -2, -1]])
```

# Apply the filter to the image
```python
x = image
f = a
x2 = np.zeros(x.shape)
```

# Convolution operation
```python
for i in range(1, x.shape[0] - 1):
    for j in range(1, x.shape[1] - 1):
        x2[i, j] = (f[0, 0] * x[i - 1, j - 1]
                    + f[0, 1] * x[i - 1, j]
                    + f[0, 2] * x[i - 1, j + 1]
                    + f[1, 0] * x[i, j - 1]
                    + f[1, 1] * x[i, j]
                    + f[1, 2] * x[i, j + 1]
                    + f[2, 0] * x[i + 1, j - 1]
                    + f[2, 1] * x[i + 1, j]
                    + f[2, 2] * x[i + 1, j + 1])
```

# Plot the original image
```python
plot(x)
```
# Plot the convoluted image
```python
plot(x2)
```

# Function to perform convolution
```python
def conv2(x, f):
    x2 = np.zeros(x.shape)
    for i in range(1, x.shape[0] - 1):
        for j in range(1, x.shape[1] - 1):
            x2[i, j] = (f[0, 0] * x[i - 1, j - 1]
                        + f[0, 1] * x[i - 1, j]
                        + f[0, 2] * x[i - 1, j + 1]
                        + f[1, 0] * x[i, j - 1]
                        + f[1, 1] * x[i, j]
                        + f[1, 2] * x[i, j + 1]
                        + f[2, 0] * x[i + 1, j - 1]
                        + f[2, 1] * x[i + 1, j]
                        + f[2, 2] * x[i + 1, j + 1])
    return x2
```

# Define a different filter
```python
a = np.matrix([[-1, -1, -1], [-1, 8, -1], [-1, -1, -1]])
```

# Apply the new filter using the conv2 function
```python
z = conv2(x, a)
```

# Plot the original image
```python
plot(x)
```

# Plot the convoluted image using the new filter
```python
plot(z)
```

# Generate and apply 10 random filters and display the convoluted images
```python
for i in range(10):
    a = 2 * np.random.random((3, 3)) - 1  # Generate a random filter
    print(a)
    z = conv2(x, a)  # Convolve the image with the random filter
    plot(z)
```

# Load the image again for further processing
```python
img_url = "https://th.bing.com/th/id/OIP.himN5x0Zvru00xUdk3p55QHaE8?pid=ImgDet&rs=1"
img = io.imread(img_url)
x = color.rgb2gray(img)
```

# Display the convoluted images using 10 different random filters
```python
for i in range(10):
    a = 2 * np.random.random((3, 3)) - 1
    print(a)
    z = convolve2d(x, a, mode='valid')  # 2D convolution
    plot(z)
```
