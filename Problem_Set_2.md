# Problem_Set_2

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1noFFUDtZzA5VH57kVLVgkjcYxsgUYUbd 


# Import necessary libraries and modules
```python
import numpy as np
import matplotlib.pyplot as plt
import base64
from io import BytesIO
from scipy.signal import convolve2d
from skimage import data, color, io
import IPython
from torchvision import datasets
from skimage.util import montage
import wandb as wb
from skimage.io import imread
from skimage.transform import resize

import numpy as np
import matplotlib.pyplot as plt
import base64
from io import BytesIO
from scipy.signal import convolve2d
from skimage import data, color, io
import IPython

import numpy as np
import matplotlib.pyplot as plt
import torch
from torchvision import datasets
from skimage.util import montage
!pip install wandb
import wandb as wb
from skimage.io import imread
from skimage.transform import resize
```
This code block sets up the environment for a project that involves image processing, convolution operations, visualization, and possibly machine learning training with experiment tracking.

# Define a function to plot an image
```python
def plot(x):
    fig, ax = plt.subplots()
    im = ax.imshow(x, cmap='gray')
    ax.axis('off')
    fig.set_size_inches(5, 5)
    plt.show()
```
The plot() function with an image will display that image in a grayscale format, without any axis, and with a size of 5x5 inches.

# Load an RGB image from a URL and display it
```python
image = io.imread("https://th.bing.com/th/id/OIP.himN5x0Zvru00xUdk3p55QHaE8?pid=ImgDet&rs=1")
image = image[:, :, :]  # Keep all color channels
plot(image)  # Display the image
```
![image](https://github.com/kristen1028/MathDataScience/assets/143013164/b4f518dc-eaba-44c3-86c2-d52fbc46acac)

This displays the image selected from a URL.

# Resize the image to 224x224 and display the resized image
```python
image_resize = resize(image, (224, 224))
plot(image_resize)  # Display the resized image
```
![image](https://github.com/kristen1028/MathDataScience/assets/143013164/23ebcc54-a407-49cc-add7-a7a2290c8cf8)

This code resizes and plots the image from the URL to 224x224.

# Convert the resized image to grayscale and display it
```python
image_gray = np.mean(image_resize, axis=2)
plot(image_gray)  # Display the grayscale image
```
![image](https://github.com/kristen1028/MathDataScience/assets/143013164/a19ac5b0-b87b-4564-8f04-219a140258f4)

This code converts a resized color image into grayscale and then displays the grayscale image.

# Define a convolution filter 'a'
```python
a = np.matrix([[-1, -1, -1], [-1, 8, -1], [-1, -1, -1]])
```
This code creates a 3x3 matrix a with specific values using the np.matrix() function from the NumPy library. 

# Convolve the grayscale image with the filter 'a' and display the results
```python
x = image_gray
x2 = conv2(x, a)
plot(x)
plot(x2)
```

This code block takes a grayscale image, applies edge detection using a filter, and displays both the original and the edge-detected images.
# Define a function for 2D convolution
```python
def conv2(x, f):
    x2 = np.zeros(x.shape)
    for i in range(1, x.shape[0] - 1):
        for j in range(1, x.shape[1] - 1):
            x2[i, j] = (
                f[0, 0] * x[i - 1, j - 1]
                + f[0, 1] * x[i - 1, j]
                + f[0, 2] * x[i - 1, j + 1]
                + f[1, 0] * x[i, j - 1]
                + f[1, 1] * x[i, j]
                + f[1, 2] * x[i, j + 1]
                + f[2, 0] * x[i + 1, j - 1]
                + f[2, 1] * x[i + 1, j]
                + f[2, 2] * x[i + 1, j + 1]
            )
    return x2
```

# Apply convolution with 10 random filters and display the results
```python
for i in range(10):
    a = 2 * np.random.random((3, 3)) - 1
    print(a)
    z = conv2(x, a)
    plot(z)
```
# Load an RGB image from a URL and convert it to grayscale
```python
img_url = "https://th.bing.com/th/id/OIP.himN5x0Zvru00xUdk3p55QHaE8?pid=ImgDet&rs=1"
img = io.imread(img_url)
x = color.rgb2gray(img)
```

# Apply convolution with 10 more random filters and display the results
```python
for i in range(10):
    a = 2 * np.random.random((3, 3)) - 1
    print(a)
    z = convolve2d(x, a, mode='valid')  # 2D convolution
    plot(z)
```
